
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Implementing morphological functions to the ecosystem &#8212; Urban Grammar AI  documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
     
<link
  rel="alternate"
  type="application/atom+xml"
  href="../blog/atom.xml"
  title="Urban Grammar AI Blog"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    


    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><center>
  <a class="navbar-brand" href="../index.html">
    <img src="../_static/logo.svg" alt="logo">
  </a>
  <p style="font-size:1.3em">Urban Grammar AI</p>
  <p style="font-size:1em">research project</p>
</center>


<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..."
    aria-label="Search the docs ..." autocomplete="off">
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
    



    <ul class="nav bd-sidenav">
      
      <li class="nav-item ">
        <a class="nav-link" href="../overview.html">Project overview</a>
      </li>
      
      <li class="nav-item ">
        <a class="nav-link" href="https://urbangrammarai.xyz/blog/archive">Updates</a>
      </li>
      
      <li class="nav-item ">
        <a class="nav-link" href="https://urbangrammarai.xyz/talks/">Public talks</a>
      </li>
      
      <li class="nav-item ">
        <a class="nav-link" href="https://urbangrammarai.xyz/data_processing/index">WP1 - Data processing</a>
      </li>
      
      <li class="nav-item ">
        <a class="nav-link" href="https://urbangrammarai.xyz/spatial_signatures/index">WP2 - Spatial Signatures</a>
      </li>
      
    </ul>

</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#speedups-of-existing-code">
   Speedups of existing code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#new-functionality">
   New functionality
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#full-list-of-contributions">
   Full list of contributions
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                 <div class="tex2jax_ignore mathjax_ignore section" id="implementing-morphological-functions-to-the-ecosystem">
<h1>Implementing morphological functions to the ecosystem<a class="headerlink" href="#implementing-morphological-functions-to-the-ecosystem" title="Permalink to this headline">¶</a></h1>
<p>This blog post covers some of the efforts the team has made to contribute code developed for the project to the broader Python eco-system for (geographic) data science. Processing of data within <a class="reference external" href="https://urbangrammarai.xyz/data_processing/index">WP1</a> and morphometric assessment within <a class="reference external" href="https://urbangrammarai.xyz/spatial_signatures/index">WP2</a> entail the development of new bespoke algorithms and implementation of some which are currently available in the Python ecosystem. However, even those already existing were often not performant enough for the scale of this project.</p>
<div class="section" id="speedups-of-existing-code">
<h2>Speedups of existing code<a class="headerlink" href="#speedups-of-existing-code" title="Permalink to this headline">¶</a></h2>
<p>As part of the data processing stage of the project, we have refactored some of them to gain the performance enhancements we needed. Since we strongly believe in replicability of research, all software developed within Urban Grammar AI project should be available for other researchers, optimally packaged in a friendly shape of a Python library. At the same time, we want to support open-source software which we use for the research.</p>
<p>We think the natural approach is to include enhancements made within the area of urban morphometrics to <a class="reference external" href="http://docs.momepy.org"><code class="docutils literal notranslate"><span class="pre">momepy</span></code></a> an existing toolkit for urban morphology. <a class="reference external" href="https://urbangrammarai.xyz/spatial_signatures/index">WP2</a> heavily builds on <code class="docutils literal notranslate"><span class="pre">momepy</span></code>’s code and every relevant piece of code we made is now merged back into <code class="docutils literal notranslate"><span class="pre">momepy</span></code>. That covers both performance-focused changes to implementation (<a class="reference external" href="https://github.com/martinfleis/momepy/pull/219">#219</a>, <a class="reference external" href="https://github.com/martinfleis/momepy/pull/209">#209</a>, <a class="reference external" href="https://github.com/martinfleis/momepy/pull/207">#207</a>, <a class="reference external" href="https://github.com/martinfleis/momepy/pull/205">#205</a>), mostly based on <code class="docutils literal notranslate"><span class="pre">pygeos</span></code> and vectorization, and new additions.</p>
</div>
<div class="section" id="new-functionality">
<h2>New functionality<a class="headerlink" href="#new-functionality" title="Permalink to this headline">¶</a></h2>
<p>Two key features of Spatial Signatures, the concepts of <a class="reference external" href="https://urbangrammarai.xyz/spatial_signatures/spatial_unit/Parallelized_enclosures.html">enclosures</a> and <a class="reference external" href="https://urbangrammarai.xyz/spatial_signatures/spatial_unit/enclosed_tessellation.html">enclosed tessellation</a> are now available in <code class="docutils literal notranslate"><span class="pre">momepy.elements</span></code> module and you can create both using only a few lines of code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">enclosures</span> <span class="o">=</span> <span class="n">momepy</span><span class="o">.</span><span class="n">enclosures</span><span class="p">(</span>
    <span class="n">streets</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">convex_hull</span><span class="p">]),</span> <span class="n">additional_barriers</span><span class="o">=</span><span class="p">[</span><span class="n">railway</span><span class="p">,</span> <span class="n">rivers</span><span class="p">])</span>

<span class="n">enclosed_tessellation</span> <span class="o">=</span> <span class="n">momepy</span><span class="o">.</span><span class="n">Tessellation</span><span class="p">(</span>
    <span class="n">buildings</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="s1">&#39;uID&#39;</span><span class="p">,</span> <span class="n">enclosures</span><span class="o">=</span><span class="n">enclosures</span><span class="p">)</span><span class="o">.</span><span class="n">tessellation</span>
</pre></div>
</div>
<p>See the detailed guidance in <a class="reference external" href="http://docs.momepy.org/en/latest/user_guide/elements/enclosed.html">momepy’s documentation</a>.</p>
<p>Tools <a class="reference external" href="https://urbangrammarai.xyz/spatial_signatures/spatial_unit/Generate_enclosures.html#preprocess-railways">we used</a> to preprocess street network and railway tracks before creating enclosures for a core of a new module <a class="reference external" href="http://docs.momepy.org/en/latest/api.html#preprocessing"><code class="docutils literal notranslate"><span class="pre">momepy.preprocessing</span></code></a>, where you can find them as <a class="reference external" href="http://docs.momepy.org/en/latest/generated/momepy.remove_false_nodes.html#momepy.remove_false_nodes"><code class="docutils literal notranslate"><span class="pre">momepy.remove_false_nodes</span></code></a>, <a class="reference external" href="http://docs.momepy.org/en/latest/generated/momepy.close_gaps.html#momepy.close_gaps"><code class="docutils literal notranslate"><span class="pre">momepy.close_gaps</span></code></a> and <a class="reference external" href="http://docs.momepy.org/en/latest/generated/momepy.extend_lines.html#momepy.extend_lines"><code class="docutils literal notranslate"><span class="pre">momepy.extend_lines</span></code></a>. To measure percentiles used as a convolution layer for delineation of Spatial Signatures, you can use <a class="reference external" href="http://docs.momepy.org/en/latest/generated/momepy.Percentiles.html#momepy.Percentiles"><code class="docutils literal notranslate"><span class="pre">momepy.Percentiles</span></code></a> and to link enclosed tessellation to street network, there is a new function <a class="reference external" href="http://docs.momepy.org/en/latest/generated/momepy.get_network_ratio.html#momepy.get_network_ratio"><code class="docutils literal notranslate"><span class="pre">momepy.get_network_ratio</span></code></a>.</p>
</div>
<div class="section" id="full-list-of-contributions">
<h2>Full list of contributions<a class="headerlink" href="#full-list-of-contributions" title="Permalink to this headline">¶</a></h2>
<p>The complete list of pull requests implementing code resulting from Urban Grammar AI is below:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/martinfleis/momepy/pull/219">#219 REF: vectorize StreetProfile</a></p></li>
<li><p><a class="reference external" href="https://github.com/martinfleis/momepy/pull/218">#218 ENH: ratio-based network links</a></p></li>
<li><p><a class="reference external" href="https://github.com/martinfleis/momepy/pull/217">#217 ENH: extend_lines</a></p></li>
<li><p><a class="reference external" href="https://github.com/martinfleis/momepy/pull/215">#215 ENH: Close gaps</a></p></li>
<li><p><a class="reference external" href="https://github.com/martinfleis/momepy/pull/214">#214 REF: preprocessing module</a></p></li>
<li><p><a class="reference external" href="https://github.com/martinfleis/momepy/pull/213">#213 API: unified Tessellation</a></p></li>
<li><p><a class="reference external" href="https://github.com/martinfleis/momepy/pull/212">#212 ENH: Enclosed tessellation</a></p></li>
<li><p><a class="reference external" href="https://github.com/martinfleis/momepy/pull/211">#211 ENH: add enclosures function</a></p></li>
<li><p><a class="reference external" href="https://github.com/martinfleis/momepy/pull/209">#209 ENH: speedups, Percentiles</a></p></li>
<li><p><a class="reference external" href="https://github.com/martinfleis/momepy/pull/207">#207 REF: pygeos-based Tessellation</a></p></li>
<li><p><a class="reference external" href="https://github.com/martinfleis/momepy/pull/205">#205 ENH: faster circular compactness</a></p></li>
<li><p><a class="reference external" href="https://github.com/martinfleis/momepy/pull/204">#204 ENH: vectorised remove_false_nodes</a></p></li>
</ul>
</div>
</div>

<div class="section">
     
<div class="section">
  <span style="float: left">
     Previous:
    
    <a href="post3.html">
       First Advisory Board
    </a>
    
  </span>
  <span>&nbsp;</span>
  <span style="float: right">
     Next: 
    <a href="post5_mapchallenge.html">
      30DayMapChallenge 2020 
    </a>
    
  </span>
</div>
  
</div>

              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020-, Dani Arribas-Bel, Martin Fleischmann.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>